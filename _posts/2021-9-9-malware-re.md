---
title: Basic Malware RE Walkthrough (tryhackme)
layout: post
categories: writups
---
## Basic Malware RE

![](/assets/images/malware_re/s0.png)


**Strings : Challenge 1**

Lets start the first task

![](/assets/images/malware_re/s1.png)

let's download the file then use PE-studio, because of the name of the task "string" I thought it was about strings so immediately I went to the strings part in pe studio and we can see there are a lot of them 

![](/assets/images/malware_re/00.png)

let's drag the file into our favorite tool IDA 

![](/assets/images/malware_re/01.png)

it is obvious that what is stored in off_432294 is pushed as a parameter for the md5_hash function (it prints generated md5 in the message box)
so just go to off_432294 and here is your flag

![](/assets/images/malware_re/02.png)

**Strings : Challenge 2**

![](/assets/images/malware_re/s2.png)

this time lets start by open the task file using IDA 

![](/assets/images/malware_re/03.png)

we can see a lot of values are pushed to the stack before calling the md5 function the solution is very easy and there is more than one way to solve it, but because I’m too lazy to open any other tool.
I’ll debug the file using ida and put a breakpoint before the calling instruction, Then I'll extract the values from the stack.

![](/assets/images/malware_re/04.png)

now we can see our dear flag in the stack 

![](/assets/images/malware_re/06.png)


**Strings : Challenge 3**

It is the last task in the room so for the same laziness reasons I'll open it using ida 

![](/assets/images/malware_re/08.png)

there is a call for two important APIs here
first one is FindResourceA (for more information about it [visit][LoadResource])
in simple words, this API will load the resource (it contains a lot of fake flags) of the file then using the second API ([LoadStringA][LoadStringA])
it will loads the targeted string using an identifier (the identifier will let us know the right flag in resource)
to know the right identifier look at the second parameter pushed to the LoadStringA 
it is (epb+var_4) which is generated before by moving 1 to eax then shift left by 8 which equal to 256
after that it shifts left 1 by 4 which equal 16, then it does an OR between 256 and 16 which equal 272
so let's open the file using resource hacker and search for the (272) identifier and voila

![](/assets/images/malware_re/09.png)


[LoadResource]: https://docs.microsoft.com/en-us/windows/win32/api/winbase/nf-winbase-findresourcea

[LoadStringA]: https://docs.microsoft.com/en-us/windows/win32/api/winuser/nf-winuser-loadstringa